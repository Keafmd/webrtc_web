{"version":3,"file":"component---src-pages-chat-js-06b229c5c7887da31d71.js","mappings":"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","sources":["webpack://gatsby-starter-hello-world/./src/component/Message.js","webpack://gatsby-starter-hello-world/./src/pages/404.js","webpack://gatsby-starter-hello-world/./src/component/SimpleVideo.js","webpack://gatsby-starter-hello-world/./src/component/SimpleVideo.module.css","webpack://gatsby-starter-hello-world/./src/pages/chat.js","webpack://gatsby-starter-hello-world/./src/pages/chat.module.css"],"sourcesContent":["import React, {useState, useImperativeHandle} from \"react\";\r\nimport './Message.css'\r\n\r\n\r\nconst Message = (props) => {\r\n\r\n    const style = props.style\r\n\r\n    const [cusAnimate, setCusAnimate] = useState(\"\");\r\n\r\n    useImperativeHandle(props.onRef, () => {\r\n        return {\r\n            show: show,\r\n        };\r\n    });\r\n\r\n    function show(ms = 2000) {\r\n        setCusAnimate(\"fadeIn\")\r\n        setTimeout(() => {\r\n            setCusAnimate(\"bounceOutUp\")\r\n        }, ms)\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div style={style} className={cusAnimate}>\r\n                {props.data.msg}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Message","import React from \"react\"\r\n\r\nconst notFound = () => (\r\n    <div>\r\n        Page Not Fount，页面不存在!\r\n        <div>\r\n            <br/>\r\n            滚滚长江东逝水，浪花淘尽英雄。\r\n            是非成败转头空。\r\n            青山依旧在，几度夕阳红。\r\n            白发渔樵江渚上，惯看秋月春风。\r\n            一壶浊酒喜相逢。\r\n            古今多少事，都付笑谈中。\r\n        </div>\r\n    </div>\r\n)\r\nexport default notFound;","import React, {useImperativeHandle,useState} from \"react\";\r\nimport * as SimpleVideoStyle from './SimpleVideo.module.css'\r\n\r\nexport default (props) => {\r\n\r\n\r\n    const [username, setUsername] = useState(\"\")\r\n\r\n    useImperativeHandle(props.onRef, () => {\r\n        return {\r\n            updateUser: updateUser,\r\n        };\r\n    });\r\n\r\n    function updateUser(newUserName){\r\n        setUsername(newUserName)\r\n    }\r\n\r\n    return (\r\n        <div className={SimpleVideoStyle.total} style={props.styles.total}>\r\n            <div className={SimpleVideoStyle.username}>{props.usernameDes} {username === \"\" ? props.username : username}</div>\r\n\r\n            <div style={{display:\"flex\",flexDirection:\"column\",alignItems:\"center\"}}>\r\n                <span style={{color:\"#166e6c\",fontSize:\"13px\"}}>{props.cameraDes}</span>\r\n                <video id={props.videoId} style={props.styles.video} className={SimpleVideoStyle.video} autoPlay/>\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}","// extracted by mini-css-extract-plugin\nexport var total = \"SimpleVideo-module--total---BTSH\";\nexport var username = \"SimpleVideo-module--username--QFbYM\";\nexport var video = \"SimpleVideo-module--video--Yc-zm\";","import React, {useState, useEffect, useRef} from \"react\";\r\nimport SimpleVideo from '../component/SimpleVideo'\r\nimport * as chatStyle from \"./chat.module.css\";\r\nimport Message from \"../component/Message\";\r\nimport G from './404'\r\n\r\nconst Chat = (props) => {\r\n\r\n    let errorFlag = false\r\n\r\n    let username;\r\n\r\n    try {\r\n        username = props.location.state.username[\"username\"]\r\n    } catch (e) {\r\n        errorFlag = true\r\n    }\r\n\r\n    const mineUserDesc = \"我方用户: \"\r\n\r\n    const remoteUserDesc = \"对方用户: \"\r\n\r\n    const localVideoId = \"localVideo\"\r\n\r\n    const remoteVideoId = \"remoteVideo\"\r\n\r\n    const [nullNotice, setNullNotice] = useState(\"hidden\");\r\n\r\n    const [remoteUser, setRemoteUser] = useState(\"\")\r\n\r\n    const remoteUserRef = useRef()\r\n\r\n    const msgNoticeRef = useRef();\r\n\r\n    const [noticeMsg, setNoticeMsg] = useState(\"\");\r\n\r\n    const [msgVisibility, setMsgVisibility] = useState(\"hidden\");\r\n\r\n    const [msgBackgroundColor, setMsgBackgroundColor] = useState(\"#aed3ae\");\r\n\r\n    const [msgColor, setMsgColor] = useState(\"#24ab15\");\r\n\r\n    const msgCommonStyle = {\r\n        width: \"300px\",\r\n        height: \"40px\",\r\n        backgroundColor: msgBackgroundColor,\r\n        display: \"flex\",\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        borderRadius: \"3px\",\r\n        visibility: msgVisibility,\r\n        border: \"1px solid #ffffff\",\r\n        fontSize: \"14px\",\r\n        lineHeight: \"1.571\",\r\n        color: msgColor\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (errorFlag) {\r\n            return\r\n        }\r\n        //设置视频video标签\r\n        simpleSdk.setVideoTag(localVideoId, remoteVideoId);\r\n    }, [])\r\n\r\n\r\n    useEffect(() => {\r\n        //监听 呼叫成功\r\n        simpleSdk.on('call-success', function (e) {\r\n            if (msgNoticeRef.current) {\r\n                popNoticeFunc(e.data.msg)\r\n            }\r\n        });\r\n\r\n        //不在线/忙\r\n        simpleSdk.onMulti(['not-online', 'busy'], function (e) {\r\n            if (msgNoticeRef.current) {\r\n                popNoticeFunc(e.data.msg, setWarningStyle)\r\n            }\r\n        });\r\n\r\n\r\n        //监听 被呼叫\r\n        simpleSdk.on('called', function (e) {\r\n            console.log(e);\r\n            let caller = e.data.msg;\r\n            if (msgNoticeRef.current) {\r\n                popNoticeFunc(`收到来自 [${caller}] 的视频邀请,3秒后将自动接受`, undefined, 4000, 4000)\r\n            }\r\n            setTimeout(() => {\r\n                simpleSdk.accept();\r\n            }, 3000);\r\n        });\r\n\r\n        //监听 对方已接受\r\n        simpleSdk.on('accepted', function () {\r\n            console.log(\"对方接受\");\r\n        });\r\n\r\n        //监听 对方已挂断\r\n        simpleSdk.on('hang-up', function (e) {\r\n\r\n        });\r\n\r\n\r\n    }, [])\r\n\r\n    function setCommonStyle() {\r\n        setMsgBackgroundColor(\"#aed3ae\")\r\n        setMsgColor(\"#24ab15\")\r\n    }\r\n\r\n    function setWarningStyle() {\r\n        setMsgBackgroundColor(\"#fff2f0\")\r\n        setMsgColor(\"#f56c6c\")\r\n    }\r\n\r\n    function popNoticeFunc(msg, setStyle = setCommonStyle, showMs = 1000, hiddenMs = 2000) {\r\n        setNoticeMsg(msg)\r\n        //背景和颜色\r\n        setStyle()\r\n        setMsgVisibility(\"visible\")\r\n        msgNoticeRef.current.show(showMs)\r\n        setTimeout(() => {\r\n            setMsgVisibility(\"hidden\")\r\n        }, hiddenMs)\r\n    }\r\n\r\n    function call() {\r\n        if (!remoteUser) {\r\n            showNotice(1500);\r\n            return;\r\n        }\r\n        simpleSdk.call(remoteUser)\r\n    }\r\n\r\n    /**\r\n     * 显示为空提示\r\n     * @param millisecond\r\n     */\r\n    function showNotice(millisecond) {\r\n        setNullNotice(\"visible\")\r\n        setTimeout(() => {\r\n            setNullNotice(\"hidden\")\r\n        }, millisecond);\r\n    }\r\n\r\n    /**\r\n     * 检查input用户名\r\n     * @param val\r\n     */\r\n    function checkInput(val) {\r\n        val = val.replace(/\\s+/g, '');\r\n        setRemoteUser(val)\r\n        remoteUserRef.current.updateUser(val)\r\n    }\r\n\r\n\r\n    return errorFlag ? G() : (\r\n        <div>\r\n            <div style={{\r\n                height: \"100vh\",\r\n                display: \"flex\",\r\n                flexDirection: \"column\",\r\n                justifyContent: \"space-evenly\",\r\n                alignItems: \"center\",\r\n            }}>\r\n\r\n                <div>\r\n                    <Message onRef={msgNoticeRef}\r\n                             data={{msg: noticeMsg}}\r\n                             style={msgCommonStyle}/>\r\n                </div>\r\n                <div className={chatStyle.des}>\r\n                    我打尼玛的啊？\r\n                </div>\r\n\r\n\r\n                <div style={{\r\n                    width: \"410px\",\r\n                    display: \"flex\",\r\n                    flexFlow: \"row wrap\",\r\n                    justifyContent: \"flex-start\",\r\n                    alignItems: \"center\"\r\n                }}>\r\n                    <svg t=\"1643784048204\" className=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\"\r\n                         xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1568\" width=\"6px\" height=\"6px\">\r\n                        <path\r\n                            d=\"M927 679.5L635.7 511.7 927 343.9c29.1-14.6 43.7-58.3 22.1-87.4-14.6-29.1-58.3-43.7-87.4-22.1L570.5 402.2V67.8c7-36.7-22.1-65.8-58.3-65.8-36.1 0-65.8 29.1-65.8 65.8v335L155.1 235c-22.1-21.6-65.8-7-80.4 22.1-14.6 29.1-7.6 72.8 22.1 87.4l291.3 167.8L96.9 680.1c-29.1 14.6-43.7 58.3-21.6 87.4 14.6 22.1 36.7 29.1 58.3 29.1 7 0 21.6 0 29.1-7.6L454 621.2v335c-7.6 36.7 22.1 65.8 58.3 65.8 36.1 0 65.2-29.1 65.2-65.8v-335L868.7 789c7.6 7.6 22.1 7.6 29.1 7.6 22.1 0 43.7-14.6 58.3-29.1 7-29.8 0-73.5-29.1-88z\"\r\n                            fill=\"#E52323\" p-id=\"1569\"/>\r\n                    </svg>\r\n                    <input className={chatStyle.input} placeholder={\"输入对方用户名呼叫\"}\r\n                           onChange={e => checkInput(e.target.value)}\r\n                           value={remoteUser}\r\n                    />\r\n\r\n                    <button className={chatStyle.callBtn} onClick={() => call()}>呼叫</button>\r\n                    <span style={{\r\n                        paddingLeft: \"7px\",\r\n                        fontSize: \"13px\",\r\n                        color: \"#de0c0c\",\r\n                        visibility: nullNotice\r\n                    }}>用户名不能为空!</span>\r\n                </div>\r\n\r\n\r\n                <div style={{\r\n                    height: \"480px\",\r\n                    display: \"flex\",\r\n                    flexDirection: \"row\",\r\n                    justifyContent: \"center\",\r\n                    alignItems: \"center\"\r\n                }}>\r\n\r\n                    <SimpleVideo\r\n                        videoId={localVideoId}\r\n                        cameraDes={\"我方摄像头\"}\r\n                        usernameDes={mineUserDesc}\r\n                        username={username}\r\n                        styles={{\r\n                            total: {width: \"640px\", height: \"480px\"},\r\n                            video: {width: \"640px\", height: \"400px\"}\r\n                        }}/>\r\n\r\n\r\n                    <SimpleVideo\r\n                        onRef={remoteUserRef}\r\n                        videoId={remoteVideoId}\r\n                        cameraDes={\"对方摄像头\"}\r\n                        usernameDes={remoteUserDesc}\r\n                        username={remoteUser}\r\n                        styles={{\r\n                            total: {width: \"640px\", height: \"480px\"},\r\n                            video: {width: \"300px\", height: \"200px\"}\r\n                        }}/>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat;","// extracted by mini-css-extract-plugin\nexport var input = \"chat-module--input--qOoOt\";\nexport var des = \"chat-module--des--jX5+j\";\nexport var callBtn = \"chat-module--callBtn--CC1G5\";"],"names":["props","style","useState","cusAnimate","setCusAnimate","show","ms","setTimeout","useImperativeHandle","onRef","className","data","msg","username","setUsername","updateUser","newUserName","styles","total","usernameDes","display","flexDirection","alignItems","color","fontSize","cameraDes","id","videoId","video","autoPlay","errorFlag","location","state","e","localVideoId","remoteVideoId","nullNotice","setNullNotice","remoteUser","setRemoteUser","remoteUserRef","useRef","msgNoticeRef","noticeMsg","setNoticeMsg","msgVisibility","setMsgVisibility","msgBackgroundColor","setMsgBackgroundColor","msgColor","setMsgColor","msgCommonStyle","width","height","backgroundColor","justifyContent","borderRadius","visibility","border","lineHeight","setCommonStyle","setWarningStyle","popNoticeFunc","setStyle","showMs","hiddenMs","current","call","millisecond","simpleSdk","useEffect","setVideoTag","on","onMulti","console","log","caller","undefined","accept","G","Message","flexFlow","t","viewBox","version","xmlns","d","fill","placeholder","onChange","val","target","value","replace","onClick","paddingLeft","SimpleVideo"],"sourceRoot":""}