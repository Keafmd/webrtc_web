{"version":3,"file":"component---src-pages-login-js-85d8fec1b93c51f0617e.js","mappings":"wJAgCA,IA5BgB,SAACA,GAEb,IAAMC,EAAQD,EAAMC,MAEpB,GAAoCC,EAAAA,EAAAA,UAAS,IAAtCC,EAAP,KAAmBC,EAAnB,KAQA,SAASC,EAAKC,QAAW,IAAXA,IAAAA,EAAK,KACfF,EAAc,UACdG,YAAW,WACPH,EAAc,iBACfE,GAGP,OAbAE,EAAAA,EAAAA,qBAAoBR,EAAMS,OAAO,WAC7B,MAAO,CACHJ,KAAMA,MAYV,2BACI,uBAAKJ,MAAOA,EAAOS,UAAWP,GACzBH,EAAMW,KAAKC,Q,+FCpBb,SAASC,IAGpB,OAAsBX,EAAAA,EAAAA,UAAS,WAAxBY,EAAP,KAAYC,EAAZ,KAEA,GAAgCb,EAAAA,EAAAA,UAAS,IAAlCc,EAAP,KAAiBC,EAAjB,KAEA,GAA0Cf,EAAAA,EAAAA,UAAS,UAA5CgB,EAAP,KAAsBC,EAAtB,KAEA,GAAkCjB,EAAAA,EAAAA,UAAS,IAApCkB,EAAP,KAAkBC,EAAlB,KAEA,GAAoCnB,EAAAA,EAAAA,UAAS,UAAtCoB,EAAP,KAAmBC,EAAnB,KAEMC,GAAeC,EAAAA,EAAAA,UAEjBC,GAAeD,EAAAA,EAAAA,UA6DnB,SAASE,IACL,IAAKX,EAED,OAnBYY,EAkBD,KAjBfL,EAAc,gBACdhB,YAAW,WACPgB,EAAc,YACfK,GAJP,IAAoBA,EAqBhBC,UAAUF,MAAMX,GAIpB,OApEAc,EAAAA,EAAAA,YAAU,WAEND,UAAUE,wBAAwB,4BACnC,IAGHF,UAAUG,GAAG,6BAA6B,WACtCjB,EAAO,yBAGXc,UAAUG,GAAG,0BAA0B,WACnCjB,EAAO,eAIXc,UAAUG,GAAG,iBAAiB,SAAUC,GAEhCT,EAAaU,SACbV,EAAaU,QAAQC,WAI7BN,UAAUG,GAAG,cAAc,SAAUC,GA4BrC,IAAuBrB,EA1Bfc,EAAaQ,UA0BEtB,EAzBDqB,EAAEtB,KAAKC,IA0BzBS,EAAaT,GACbO,EAAiB,WACjBO,EAAaQ,QAAQ7B,KAAK,KAC1BE,YAAW,WACPY,EAAiB,YAClB,SAYA,uBAAKT,UCrFC,4BDsFT,gBAAC0B,EAAA,EAAD,CAAS3B,MAAOiB,EACPf,KAAM,CAACC,IAAKQ,GACZnB,MAAO,CACHoC,MAAO,QACPC,OAAQ,OACRC,gBAAiB,UACjBC,QAAS,OACTC,eAAgB,SAChBC,WAAY,SACZC,aAAc,MACdC,WAAY1B,EACZ2B,aAAc,MACdC,OAAQ,oBACRC,SAAU,OACVC,WAAY,QACZC,MAAO,aAIpB,gBAAC,KAAD,CAAMC,GAAI,QAASC,MAAO,CAACnC,SAAU,CAACA,SAAAA,KAClC,uBAAKoC,IAAK5B,EAAcvB,MAAO,CAACuC,QAAS,SAAzC,YAEJ,uBAAK9B,UCjHM,8BDkHP,uBAAKA,UCjHG,+BDkHHI,GAGL,uBAAKJ,UCpHS,qCDqHV,uBAAK2C,EAAE,gBAAgB3C,UAAU,OAAO4C,QAAQ,gBAAgBC,QAAQ,MACnEC,MAAM,6BAA6B,OAAK,OAAOnB,MAAM,MAAMC,OAAO,OACnE,wBACImB,EAAE,ufACFC,KAAK,UAAU,OAAK,UAE5B,yBAAOhD,UC1HJ,6BD0HiCiD,YAAa,QAASC,SAAU,SAAA3B,GAAC,OApE7E4B,GADgBA,EAqE4E5B,EAAE6B,OAAOC,OApE3FC,QAAQ,OAAQ,SAC1B/C,EAAY4C,GAFhB,IAAoBA,GAsEDE,MAAO/C,IACd,wBAAMf,MAAO,CACTgE,YAAa,MACblB,SAAU,OACVE,MAAO,UACPL,WAAYtB,IAJhB,aAQJ,0BAAQZ,UCnIK,mCDmI8BwD,QAAS,kBAAMvC,MAA1D","sources":["webpack://gatsby-starter-hello-world/./src/component/Message.js","webpack://gatsby-starter-hello-world/./src/pages/login.js","webpack://gatsby-starter-hello-world/./src/pages/login.module.css"],"sourcesContent":["import React, {useState, useImperativeHandle} from \"react\";\r\nimport './Message.css'\r\n\r\n\r\nconst Message = (props) => {\r\n\r\n    const style = props.style\r\n\r\n    const [cusAnimate, setCusAnimate] = useState(\"\");\r\n\r\n    useImperativeHandle(props.onRef, () => {\r\n        return {\r\n            show: show,\r\n        };\r\n    });\r\n\r\n    function show(ms = 2000) {\r\n        setCusAnimate(\"fadeIn\")\r\n        setTimeout(() => {\r\n            setCusAnimate(\"bounceOutUp\")\r\n        }, ms)\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <div style={style} className={cusAnimate}>\r\n                {props.data.msg}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Message","import React, {useState, useEffect, useRef} from 'react';\r\nimport * as loginStyle from './login.module.css'\r\nimport {Link} from \"gatsby\"\r\n// import simpleSdk from \"../lib/simpleSdk\";\r\nimport Message from \"../component/Message\";\r\n\r\nexport default function Login() {\r\n\r\n    //描述(连接服务器失败或成功)\r\n    const [des, setDes] = useState(\"Welcome\");\r\n    //用户名\r\n    const [username, setUsername] = useState(\"\");\r\n    //弹框提示\r\n    const [msgVisibility, setMsgVisibility] = useState(\"hidden\");\r\n    //弹框消息\r\n    const [noticeMsg, setNoticeMsg] = useState(\"\");\r\n    //控制显示用户名为空提示\r\n    const [nullNotice, setNullNotice] = useState(\"hidden\");\r\n\r\n    const routePageRef = useRef();\r\n\r\n    let smgNoticeRef = useRef();\r\n\r\n    useEffect(() => {\r\n        //打开websocket连接\r\n        simpleSdk.openWebSocketConnection(\"ws://127.0.0.1:9000/ws\");\r\n    }, []);\r\n\r\n    //监听服务器连接\r\n    simpleSdk.on(\"connection-server-success\", () => {\r\n        setDes(\"连接服务器成功,输入用户名开始聊天!\")\r\n    });\r\n\r\n    simpleSdk.on(\"connection-server-fail\", () => {\r\n        setDes(\"连接服务器失败!\")\r\n    });\r\n\r\n    //监听登录成功/失败\r\n    simpleSdk.on('login-success', function (e) {\r\n        //跳转页面\r\n        if (routePageRef.current) {\r\n            routePageRef.current.click()\r\n        }\r\n    });\r\n\r\n    simpleSdk.on('login-fail', function (e) {\r\n        //弹框提示\r\n        if (smgNoticeRef.current) {\r\n            popNoticeFunc(e.data.msg)\r\n        }\r\n    });\r\n\r\n\r\n    /**\r\n     * 检查input用户名\r\n     * @param val\r\n     */\r\n    function checkInput(val) {\r\n        val = val.replace(/\\s+/g, '');\r\n        setUsername(val)\r\n    }\r\n\r\n    /**\r\n     * 显示为空提示\r\n     * @param millisecond\r\n     */\r\n    function showNotice(millisecond) {\r\n        setNullNotice(\"visible\")\r\n        setTimeout(() => {\r\n            setNullNotice(\"hidden\")\r\n        }, millisecond);\r\n    }\r\n\r\n    function popNoticeFunc(msg) {\r\n        setNoticeMsg(msg)\r\n        setMsgVisibility(\"visible\")\r\n        smgNoticeRef.current.show(1000)\r\n        setTimeout(() => {\r\n            setMsgVisibility(\"hidden\")\r\n        }, 2000)\r\n    }\r\n\r\n    function login() {\r\n        if (!username) {\r\n            showNotice(1500);\r\n            return\r\n        }\r\n        simpleSdk.login(username)\r\n        // popNoticeFunc(\"dasdasdas\")\r\n    }\r\n\r\n    return <div className={loginStyle.out}>\r\n        <Message onRef={smgNoticeRef}\r\n                 data={{msg: noticeMsg}}\r\n                 style={{\r\n                     width: \"300px\",\r\n                     height: \"40px\",\r\n                     backgroundColor: \"#fff2f0\",\r\n                     display: \"flex\",\r\n                     justifyContent: \"center\",\r\n                     alignItems: \"center\",\r\n                     borderRadius: \"3px\",\r\n                     visibility: msgVisibility,\r\n                     marginBottom: \"50%\",\r\n                     border: \"1px solid #ffffff\",\r\n                     fontSize: \"14px\",\r\n                     lineHeight: \"1.571\",\r\n                     color: \"#f56c6c\"\r\n                 }}>\r\n\r\n        </Message>\r\n        <Link to={\"/chat\"} state={{username: {username}}}>\r\n            <div ref={routePageRef} style={{display: \"none\"}}> ignore</div>\r\n        </Link>\r\n        <div className={loginStyle.login}>\r\n            <div className={loginStyle.server}>\r\n                {des}\r\n            </div>\r\n\r\n            <div className={loginStyle.inputAndStar}>\r\n                <svg t=\"1643784048204\" className=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\"\r\n                     xmlns=\"http://www.w3.org/2000/svg\" p-id=\"1568\" width=\"6px\" height=\"6px\">\r\n                    <path\r\n                        d=\"M927 679.5L635.7 511.7 927 343.9c29.1-14.6 43.7-58.3 22.1-87.4-14.6-29.1-58.3-43.7-87.4-22.1L570.5 402.2V67.8c7-36.7-22.1-65.8-58.3-65.8-36.1 0-65.8 29.1-65.8 65.8v335L155.1 235c-22.1-21.6-65.8-7-80.4 22.1-14.6 29.1-7.6 72.8 22.1 87.4l291.3 167.8L96.9 680.1c-29.1 14.6-43.7 58.3-21.6 87.4 14.6 22.1 36.7 29.1 58.3 29.1 7 0 21.6 0 29.1-7.6L454 621.2v335c-7.6 36.7 22.1 65.8 58.3 65.8 36.1 0 65.2-29.1 65.2-65.8v-335L868.7 789c7.6 7.6 22.1 7.6 29.1 7.6 22.1 0 43.7-14.6 58.3-29.1 7-29.8 0-73.5-29.1-88z\"\r\n                        fill=\"#E52323\" p-id=\"1569\"/>\r\n                </svg>\r\n                <input className={loginStyle.input} placeholder={\"输入用户名\"} onChange={e => checkInput(e.target.value)}\r\n                       value={username}/>\r\n                <span style={{\r\n                    paddingLeft: \"7px\",\r\n                    fontSize: \"13px\",\r\n                    color: \"#de0c0c\",\r\n                    visibility: nullNotice\r\n                }}>用户名不能为空!</span>\r\n            </div>\r\n\r\n            <button className={loginStyle.loginButton} onClick={() => login()}>登录</button>\r\n        </div>\r\n    </div>\r\n}","// extracted by mini-css-extract-plugin\nexport var login = \"login-module--login--fR6qE\";\nexport var server = \"login-module--server--cWk5c\";\nexport var inputAndStar = \"login-module--inputAndStar--o10eS\";\nexport var input = \"login-module--input--ACtII\";\nexport var loginButton = \"login-module--loginButton--TR0+H\";\nexport var out = \"login-module--out--bZSqG\";"],"names":["props","style","useState","cusAnimate","setCusAnimate","show","ms","setTimeout","useImperativeHandle","onRef","className","data","msg","Login","des","setDes","username","setUsername","msgVisibility","setMsgVisibility","noticeMsg","setNoticeMsg","nullNotice","setNullNotice","routePageRef","useRef","smgNoticeRef","login","millisecond","simpleSdk","useEffect","openWebSocketConnection","on","e","current","click","Message","width","height","backgroundColor","display","justifyContent","alignItems","borderRadius","visibility","marginBottom","border","fontSize","lineHeight","color","to","state","ref","t","viewBox","version","xmlns","d","fill","placeholder","onChange","val","target","value","replace","paddingLeft","onClick"],"sourceRoot":""}